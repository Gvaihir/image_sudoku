diff --git a/aae_recons_2Dlatent.ipynb b/aae_recons_2Dlatent.ipynb
index 86e64ea..f45b59e 100644
--- a/aae_recons_2Dlatent.ipynb
+++ b/aae_recons_2Dlatent.ipynb
@@ -180,7 +180,7 @@
     "    \n",
     "    \n",
     "    \n",
-    "    ae_res = autoencoder.evaluate_generator(train_data)[0]\n",
+    "    ae_res = autoencoder.evaluate_generator(train_data, steps=len(train_data))[0]\n",
     "    adv_res = np.mean(discriminator_batch_losses)\n",
     "    \n",
     "    print('Class: {}\\nae_loss: {}\\nadv_loss: {}'.format(cell_pheno, ae_res, adv_res))\n",
diff --git a/aae_recons_test.ipynb b/aae_recons_test.ipynb
index 89816c4..d1fd35e 100644
--- a/aae_recons_test.ipynb
+++ b/aae_recons_test.ipynb
@@ -10,17 +10,9 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 1,
+   "execution_count": 6,
    "metadata": {},
-   "outputs": [
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "Using TensorFlow backend.\n"
-     ]
-    }
-   ],
+   "outputs": [],
    "source": [
     "import argparse\n",
     "from argparse import RawTextHelpFormatter\n",
@@ -55,40 +47,16 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 2,
+   "execution_count": 7,
    "metadata": {},
    "outputs": [
     {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
-      "Instructions for updating:\n",
-      "Colocations handled automatically by placer.\n"
-     ]
-    },
-    {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:310: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
-      "  warnings.warn('No training configuration found in save file: '\n"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\n",
-      "Instructions for updating:\n",
-      "Use tf.cast instead.\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:350: UserWarning: Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:292: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
+      "  warnings.warn('No training configuration found in save file: '\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:327: UserWarning: Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\n",
       "  warnings.warn('Error in loading the saved optimizer '\n"
      ]
     }
@@ -111,7 +79,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 3,
+   "execution_count": 8,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -135,7 +103,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 4,
+   "execution_count": 10,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -179,7 +147,7 @@
     "    \n",
     "    \n",
     "    \n",
-    "    ae_res = autoencoder.evaluate_generator(train_data)[0]\n",
+    "    ae_res = autoencoder.evaluate_generator(train_data, steps=len(train_data))[0]\n",
     "    adv_res = np.mean(discriminator_batch_losses)\n",
     "    \n",
     "    print('Class: {}\\nae_loss: {}\\nadv_loss: {}'.format(cell_pheno, ae_res, adv_res))\n",
@@ -198,7 +166,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 5,
+   "execution_count": 11,
    "metadata": {},
    "outputs": [
     {
@@ -222,562 +190,166 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "112/112 [==============================] - 0s 2ms/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 163us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "42/42 [==============================] - 0s 292us/step\n",
+      "112/112 [==============================] - 0s 3ms/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 111us/step\n",
+      "112/112 [==============================] - 0s 112us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 128us/step\n",
+      "112/112 [==============================] - 0s 132us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 123us/step\n",
+      "112/112 [==============================] - 0s 128us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 132us/step\n",
+      "112/112 [==============================] - 0s 131us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 113us/step\n",
+      "42/42 [==============================] - 0s 156us/step\n",
       "Class: confluent\n",
-      "ae_loss: 0.003999746390260183\n",
-      "adv_loss: 0.7838552573181334\n",
+      "ae_loss: 0.004031298604483406\n",
+      "adv_loss: 0.7920148280688695\n",
       "Found 313 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "66/66 [==============================] - 0s 278us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "66/66 [==============================] - 0s 144us/step\n",
       "Class: cytokinesis\n",
-      "ae_loss: 0.004865132601033099\n",
-      "adv_loss: 0.8199764293595653\n",
+      "ae_loss: 0.004950338343795115\n",
+      "adv_loss: 0.8213287658376611\n",
       "Found 5616 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 164us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 162us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 163us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 180us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "32/32 [==============================] - 0s 164us/step\n",
-      "Class: negative\n",
-      "ae_loss: 0.0028489736542954744\n",
-      "adv_loss: 0.7394266509605096\n",
-      "Found 310 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "60/60 [==============================] - 0s 257us/step\n",
-      "Class: nuclear_mess\n",
-      "ae_loss: 0.005030986928050557\n",
-      "adv_loss: 0.8409712989178916\n",
-      "Found 4287 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "62/62 [==============================] - 0s 257us/step\n",
-      "Class: large_nuclei\n",
-      "ae_loss: 0.003895421010538317\n",
-      "adv_loss: 0.8245990864606582\n",
-      "Found 1077 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 180us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 163us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "26/26 [==============================] - 0s 183us/step\n",
-      "Class: other\n",
-      "ae_loss: 0.0028547980172339976\n",
-      "adv_loss: 0.751026201248169\n",
-      "Found 358 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "44/44 [==============================] - 0s 312us/step\n",
-      "Class: micronuclei\n",
-      "ae_loss: 0.004372820632750762\n",
-      "adv_loss: 0.8483473320175411\n",
-      "Found 1029 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "42/42 [==============================] - 0s 291us/step\n",
-      "Class: spindle\n",
-      "ae_loss: 0.0031876518758533357\n",
-      "adv_loss: 0.7453198668950782\n",
-      "Found 264 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "80/80 [==============================] - 0s 257us/step\n",
-      "Class: Y\n",
-      "ae_loss: 0.004116984437022245\n",
-      "adv_loss: 0.7382923630305699\n",
-      "Found 448 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "Class: binucleated\n",
-      "ae_loss: 0.0037007886567153037\n",
-      "adv_loss: 0.8000463188758918\n",
-      "Found 7027 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 164us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 163us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 162us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 164us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 163us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "54/54 [==============================] - 0s 289us/step\n",
-      "Class: new_neg\n",
-      "ae_loss: 0.003238311602086066\n",
-      "adv_loss: 0.7691261381689285\n",
-      "Found 560 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "Class: polarity\n",
-      "ae_loss: 0.003786890348419547\n",
-      "adv_loss: 0.7517852736370904\n",
-      "Found 5319 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "110/110 [==============================] - 0s 172us/step\n",
-      "Class: croissant\n",
-      "ae_loss: 0.0036426187203740055\n",
-      "adv_loss: 0.7521523842376466\n"
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 110us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 110us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 247us/step\n",
+      "112/112 [==============================] - 0s 110us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 110us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 105us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 104us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 108us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "112/112 [==============================] - 0s 106us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 102us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 103us/step\n",
+      "32/32 [==============================] - 0s 96us/step\n"
+     ]
+    },
+    {
+     "ename": "KeyboardInterrupt",
+     "evalue": "",
+     "output_type": "error",
+     "traceback": [
+      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
+      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
+      "\u001b[0;32m<ipython-input-11-7e4f6f8b0bb5>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mdirs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0misdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manomaly_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcell_pheno\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdirs\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
+      "\u001b[0;32m<ipython-input-11-7e4f6f8b0bb5>\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mdirs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0misdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manomaly_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcell_pheno\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdirs\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
+      "\u001b[0;32m<ipython-input-10-b9d62c6ad9b3>\u001b[0m in \u001b[0;36manomaly_score\u001b[0;34m(cell_pheno)\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     40\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 41\u001b[0;31m     \u001b[0mae_res\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mautoencoder\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate_generator\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msteps\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_data\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     42\u001b[0m     \u001b[0madv_res\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdiscriminator_batch_losses\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     43\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/legacy/interfaces.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     89\u001b[0m                 warnings.warn('Update your `' + object_name + '` call to the ' +\n\u001b[1;32m     90\u001b[0m                               'Keras 2 API: ' + signature, stacklevel=2)\n\u001b[0;32m---> 91\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     92\u001b[0m         \u001b[0mwrapper\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_original_function\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     93\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mevaluate_generator\u001b[0;34m(self, generator, steps, max_queue_size, workers, use_multiprocessing, verbose)\u001b[0m\n\u001b[1;32m   1470\u001b[0m             \u001b[0mworkers\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mworkers\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1471\u001b[0m             \u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1472\u001b[0;31m             verbose=verbose)\n\u001b[0m\u001b[1;32m   1473\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1474\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0minterfaces\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlegacy_generator_methods_support\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training_generator.py\u001b[0m in \u001b[0;36mevaluate_generator\u001b[0;34m(model, generator, steps, max_queue_size, workers, use_multiprocessing, verbose)\u001b[0m\n\u001b[1;32m    344\u001b[0m                                  \u001b[0;34m'or (x, y). Found: '\u001b[0m \u001b[0;34m+\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    345\u001b[0m                                  str(generator_output))\n\u001b[0;32m--> 346\u001b[0;31m             \u001b[0mouts\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtest_on_batch\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0msample_weight\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    347\u001b[0m             \u001b[0mouts\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mto_list\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mouts\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    348\u001b[0m             \u001b[0mouts_per_batch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mouts\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mtest_on_batch\u001b[0;34m(self, x, y, sample_weight)\u001b[0m\n\u001b[1;32m   1254\u001b[0m             \u001b[0mins\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mx\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0my\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0msample_weights\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1255\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_make_test_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1256\u001b[0;31m         \u001b[0moutputs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtest_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mins\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1257\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0munpack_singleton\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1258\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, inputs)\u001b[0m\n\u001b[1;32m   2713\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_legacy_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2714\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2715\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_call\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2716\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2717\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mpy_any\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mis_tensor\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0minputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py\u001b[0m in \u001b[0;36m_call\u001b[0;34m(self, inputs)\u001b[0m\n\u001b[1;32m   2673\u001b[0m             \u001b[0mfetched\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_callable_fn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marray_vals\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrun_metadata\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrun_metadata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2674\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2675\u001b[0;31m             \u001b[0mfetched\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_callable_fn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0marray_vals\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2676\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mfetched\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moutputs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2677\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/client/session.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1456\u001b[0m         ret = tf_session.TF_SessionRunCallable(self._session._session,\n\u001b[1;32m   1457\u001b[0m                                                \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_handle\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1458\u001b[0;31m                                                run_metadata_ptr)\n\u001b[0m\u001b[1;32m   1459\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mrun_metadata\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1460\u001b[0m           \u001b[0mproto_data\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtf_session\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTF_GetBuffer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrun_metadata_ptr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
      ]
     }
    ],
@@ -796,32 +368,9 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 6,
+   "execution_count": null,
    "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/plain": [
-       "[['confluent', [0.003999746390260183, 0.7838552573181334]],\n",
-       " ['cytokinesis', [0.004865132601033099, 0.8199764293595653]],\n",
-       " ['negative', [0.0028489736542954744, 0.7394266509605096]],\n",
-       " ['nuclear_mess', [0.005030986928050557, 0.8409712989178916]],\n",
-       " ['large_nuclei', [0.003895421010538317, 0.8245990864606582]],\n",
-       " ['other', [0.0028547980172339976, 0.751026201248169]],\n",
-       " ['micronuclei', [0.004372820632750762, 0.8483473320175411]],\n",
-       " ['spindle', [0.0031876518758533357, 0.7453198668950782]],\n",
-       " ['Y', [0.004116984437022245, 0.7382923630305699]],\n",
-       " ['binucleated', [0.0037007886567153037, 0.8000463188758918]],\n",
-       " ['new_neg', [0.003238311602086066, 0.7691261381689285]],\n",
-       " ['polarity', [0.003786890348419547, 0.7517852736370904]],\n",
-       " ['croissant', [0.0036426187203740055, 0.7521523842376466]]]"
-      ]
-     },
-     "execution_count": 6,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
+   "outputs": [],
    "source": [
     "results"
    ]
@@ -1051,7 +600,7 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.3"
+   "version": "3.7.5"
   }
  },
  "nbformat": 4,
diff --git a/aae_recons_test_5k.ipynb b/aae_recons_test_5k.ipynb
index 1fadfe0..d7a4966 100644
--- a/aae_recons_test_5k.ipynb
+++ b/aae_recons_test_5k.ipynb
@@ -17,7 +17,31 @@
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "Using TensorFlow backend.\n"
+      "Using TensorFlow backend.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint8 = np.dtype([(\"qint8\", np.int8, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_quint8 = np.dtype([(\"quint8\", np.uint8, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint16 = np.dtype([(\"qint16\", np.int16, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_quint16 = np.dtype([(\"quint16\", np.uint16, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  _np_qint32 = np.dtype([(\"qint32\", np.int32, 1)])\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.\n",
+      "  np_resource = np.dtype([(\"resource\", np.ubyte, 1)])\n"
      ]
     }
    ],
@@ -62,16 +86,29 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
-      "Instructions for updating:\n",
-      "Colocations handled automatically by placer.\n"
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3976: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:245: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:1834: The name tf.nn.fused_batch_norm is deprecated. Please use tf.compat.v1.nn.fused_batch_norm instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:2018: The name tf.image.resize_nearest_neighbor is deprecated. Please use tf.compat.v1.image.resize_nearest_neighbor instead.\n",
+      "\n"
      ]
     },
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:310: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:292: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
       "  warnings.warn('No training configuration found in save file: '\n"
      ]
     },
@@ -79,16 +116,18 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.\n",
+      "\n",
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.\n",
       "Instructions for updating:\n",
-      "Use tf.cast instead.\n"
+      "Use tf.where in 2.0, which has the same broadcast rule as np.where\n"
      ]
     },
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:350: UserWarning: Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:327: UserWarning: Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\n",
       "  warnings.warn('Error in loading the saved optimizer '\n"
      ]
     }
@@ -179,7 +218,7 @@
     "    \n",
     "    \n",
     "    \n",
-    "    ae_res = autoencoder.evaluate_generator(train_data)[0]\n",
+    "    ae_res = autoencoder.evaluate_generator(train_data,steps=len(train_data))[0]\n",
     "    adv_res = np.mean(discriminator_batch_losses)\n",
     "    \n",
     "    print('Class: {}\\nae_loss: {}\\nadv_loss: {}'.format(cell_pheno, ae_res, adv_res))\n",
@@ -223,561 +262,46 @@
      "output_type": "stream",
      "text": [
       "112/112 [==============================] - 0s 2ms/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "42/42 [==============================] - 0s 306us/step\n",
-      "Class: confluent\n",
-      "ae_loss: 0.0034052236029543936\n",
-      "adv_loss: 0.754055334499904\n",
-      "Found 313 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "66/66 [==============================] - 0s 268us/step\n",
-      "Class: cytokinesis\n",
-      "ae_loss: 0.004359389560076947\n",
-      "adv_loss: 0.732357252383817\n",
-      "Found 5616 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 185us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 180us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 180us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 182us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "32/32 [==============================] - 0s 167us/step\n",
-      "Class: negative\n",
-      "ae_loss: 0.0014301026918251396\n",
-      "adv_loss: 0.6075794384031012\n",
-      "Found 310 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "60/60 [==============================] - 0s 249us/step\n",
-      "Class: nuclear_mess\n",
-      "ae_loss: 0.004129623309258492\n",
-      "adv_loss: 0.7520139057957936\n",
-      "Found 4287 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 184us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 218us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "62/62 [==============================] - 0s 244us/step\n",
-      "Class: large_nuclei\n",
-      "ae_loss: 0.0030731885049406094\n",
-      "adv_loss: 0.7121684663873923\n",
-      "Found 1077 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "26/26 [==============================] - 0s 179us/step\n",
-      "Class: other\n",
-      "ae_loss: 0.002456321523065645\n",
-      "adv_loss: 0.8125651819365366\n",
-      "Found 358 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "44/44 [==============================] - 0s 278us/step\n",
-      "Class: micronuclei\n",
-      "ae_loss: 0.003850285675345436\n",
-      "adv_loss: 0.7736642764870886\n",
-      "Found 1029 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "42/42 [==============================] - 0s 294us/step\n",
-      "Class: spindle\n",
-      "ae_loss: 0.0026908186533596036\n",
-      "adv_loss: 0.7742328436153575\n",
-      "Found 264 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "80/80 [==============================] - 0s 286us/step\n",
-      "Class: Y\n",
-      "ae_loss: 0.0033430529292672873\n",
-      "adv_loss: 0.7907399606704713\n",
-      "Found 448 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "Class: binucleated\n",
-      "ae_loss: 0.0030120970914140344\n",
-      "adv_loss: 0.7338631946061338\n",
-      "Found 7027 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 193us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 181us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 180us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 182us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 165us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "54/54 [==============================] - 0s 325us/step\n",
-      "Class: new_neg\n",
-      "ae_loss: 0.0027142430190990967\n",
-      "adv_loss: 0.7177453613470471\n",
-      "Found 560 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "Class: polarity\n",
-      "ae_loss: 0.003120486275292933\n",
-      "adv_loss: 0.7466565872941698\n",
-      "Found 5319 images belonging to 1 classes.\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 183us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 173us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 166us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 174us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 172us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 170us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 167us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 168us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 171us/step\n",
-      "112/112 [==============================] - 0s 169us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 184us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "112/112 [==============================] - 0s 182us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 184us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "112/112 [==============================] - 0s 179us/step\n",
-      "112/112 [==============================] - 0s 178us/step\n",
-      "112/112 [==============================] - 0s 176us/step\n",
-      "112/112 [==============================] - 0s 183us/step\n",
-      "112/112 [==============================] - 0s 183us/step\n",
-      "112/112 [==============================] - 0s 177us/step\n",
-      "112/112 [==============================] - 0s 175us/step\n",
-      "110/110 [==============================] - 0s 171us/step\n",
-      "Class: croissant\n",
-      "ae_loss: 0.0031357731660160886\n",
-      "adv_loss: 0.7522197498528825\n"
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "112/112 [==============================] - 0s 101us/step\n",
+      "112/112 [==============================] - 0s 109us/step\n",
+      "112/112 [==============================] - 0s 115us/step\n",
+      "112/112 [==============================] - 0s 119us/step\n",
+      "112/112 [==============================] - 0s 119us/step\n",
+      "112/112 [==============================] - 0s 121us/step\n",
+      "112/112 [==============================] - 0s 96us/step\n",
+      "112/112 [==============================] - 0s 97us/step\n",
+      "112/112 [==============================] - 0s 97us/step\n",
+      "112/112 [==============================] - 0s 99us/step\n",
+      "112/112 [==============================] - 0s 107us/step\n",
+      "112/112 [==============================] - 0s 97us/step\n",
+      "112/112 [==============================] - 0s 96us/step\n",
+      "112/112 [==============================] - 0s 100us/step\n",
+      "42/42 [==============================] - 0s 155us/step\n"
+     ]
+    },
+    {
+     "ename": "ValueError",
+     "evalue": "`steps=None` is only valid for a generator based on the `keras.utils.Sequence` class. Please specify `steps` or use the `keras.utils.Sequence` class.",
+     "output_type": "error",
+     "traceback": [
+      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
+      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
+      "\u001b[0;32m<ipython-input-5-7e4f6f8b0bb5>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mdirs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0misdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manomaly_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcell_pheno\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdirs\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
+      "\u001b[0;32m<ipython-input-5-7e4f6f8b0bb5>\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mdirs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0misdir\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"/home/aogorodnikov/classes_rgb_corrected/\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mresults\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0manomaly_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcell_pheno\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mx\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdirs\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
+      "\u001b[0;32m<ipython-input-4-a6308e5378cb>\u001b[0m in \u001b[0;36manomaly_score\u001b[0;34m(cell_pheno)\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     40\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 41\u001b[0;31m     \u001b[0mae_res\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mautoencoder\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate_generator\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_data\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     42\u001b[0m     \u001b[0madv_res\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmean\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdiscriminator_batch_losses\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     43\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/legacy/interfaces.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     89\u001b[0m                 warnings.warn('Update your `' + object_name + '` call to the ' +\n\u001b[1;32m     90\u001b[0m                               'Keras 2 API: ' + signature, stacklevel=2)\n\u001b[0;32m---> 91\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     92\u001b[0m         \u001b[0mwrapper\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_original_function\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     93\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training.py\u001b[0m in \u001b[0;36mevaluate_generator\u001b[0;34m(self, generator, steps, max_queue_size, workers, use_multiprocessing, verbose)\u001b[0m\n\u001b[1;32m   1470\u001b[0m             \u001b[0mworkers\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mworkers\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1471\u001b[0m             \u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0muse_multiprocessing\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1472\u001b[0;31m             verbose=verbose)\n\u001b[0m\u001b[1;32m   1473\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1474\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0minterfaces\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlegacy_generator_methods_support\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;32m~/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training_generator.py\u001b[0m in \u001b[0;36mevaluate_generator\u001b[0;34m(model, generator, steps, max_queue_size, workers, use_multiprocessing, verbose)\u001b[0m\n\u001b[1;32m    299\u001b[0m             \u001b[0msteps\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgenerator\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    300\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 301\u001b[0;31m             raise ValueError('`steps=None` is only valid for a generator'\n\u001b[0m\u001b[1;32m    302\u001b[0m                              \u001b[0;34m' based on the `keras.utils.Sequence` class.'\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    303\u001b[0m                              \u001b[0;34m' Please specify `steps` or use the'\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
+      "\u001b[0;31mValueError\u001b[0m: `steps=None` is only valid for a generator based on the `keras.utils.Sequence` class. Please specify `steps` or use the `keras.utils.Sequence` class."
      ]
     }
    ],
@@ -1090,7 +614,7 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.3"
+   "version": "3.7.5"
   }
  },
  "nbformat": 4,
diff --git a/plan.ipynb b/plan.ipynb
index 519b1cb..d94fff1 100644
--- a/plan.ipynb
+++ b/plan.ipynb
@@ -590,7 +590,10 @@
     "2. Do also grid for reconstruction  \n",
     "\n",
     "# Update 191030  \n",
-    "ACAE raedy for predictions. Tested on classes - seems that it does not very well differentiate between phenotype and normal cells (see `aae_filter_inspect`). Create a deeper net and increase number of latent dimenstions."
+    "ACAE raedy for predictions. Tested on classes - seems that it does not very well differentiate between phenotype and normal cells (see `aae_filter_inspect`). Create a deeper net and increase number of latent dimenstions.\n",
+    "\n",
+    "# Update 191112  \n",
+    "ACAE actualle makes very goo separation after debugging."
    ]
   },
   {
@@ -617,7 +620,7 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.7.3"
+   "version": "3.7.5"
   }
  },
  "nbformat": 4,
