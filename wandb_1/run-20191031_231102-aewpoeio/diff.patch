diff --git a/aae_filter_test.ipynb b/aae_filter_test.ipynb
index d4f1d0e..f8bdec2 100644
--- a/aae_filter_test.ipynb
+++ b/aae_filter_test.ipynb
@@ -2,7 +2,7 @@
  "cells": [
   {
    "cell_type": "code",
-   "execution_count": 16,
+   "execution_count": 33,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -32,7 +32,8 @@
     "from scipy.stats import entropy\n",
     "from scipy.stats import norm, kstest\n",
     "from scipy.spatial.distance import jensenshannon as jsd\n",
-    "\n"
+    "\n",
+    "import seaborn as sns"
    ]
   },
   {
@@ -44,7 +45,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 17,
+   "execution_count": 2,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -55,7 +56,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 18,
+   "execution_count": 3,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -84,16 +85,23 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 19,
+   "execution_count": 4,
    "metadata": {},
    "outputs": [
     {
+     "name": "stdout",
+     "output_type": "stream",
+     "text": [
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
+      "Instructions for updating:\n",
+      "Colocations handled automatically by placer.\n"
+     ]
+    },
+    {
      "name": "stderr",
      "output_type": "stream",
      "text": [
       "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:310: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
-      "  warnings.warn('No training configuration found in save file: '\n",
-      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/saving.py:310: UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.\n",
       "  warnings.warn('No training configuration found in save file: '\n"
      ]
     }
@@ -104,7 +112,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 20,
+   "execution_count": 5,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -119,7 +127,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 11,
+   "execution_count": 6,
    "metadata": {},
    "outputs": [],
    "source": [
@@ -135,73 +143,6 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 6,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "def anomaly_score(img_wd, batch, input_dim):\n",
-    "    # TODO: docsting\n",
-    "    data_loader = ImageDataGenerator(\n",
-    "        rescale=1. / 255,\n",
-    "        featurewise_center=True,\n",
-    "        featurewise_std_normalization=True,\n",
-    "        shear_range=0.2,\n",
-    "        zoom_range=0.2,\n",
-    "        horizontal_flip=True)\n",
-    "\n",
-    "    train_data = data_loader.flow_from_directory(\n",
-    "        img_wd,\n",
-    "        target_size=(input_dim[0], input_dim[0]),\n",
-    "        batch_size=batch,\n",
-    "        class_mode='input')\n",
-    "    \n",
-    "    batch_index = 0\n",
-    "    discriminator_batch_losses = []\n",
-    "    while batch_index <= train_data.batch_index:\n",
-    "        data = train_data.next()\n",
-    "        data_list = data[0]\n",
-    "        data_size = len(data_list)\n",
-    "\n",
-    "        fake_latent = encoder.predict(data_list)\n",
-    "        discriminator_input = np.concatenate((fake_latent, np.random.randn(data_size, latent_dim) * 5.))\n",
-    "        discriminator_labels = np.concatenate((np.zeros((data_size, 1)), np.ones((data_size, 1))))\n",
-    "        discriminator_history = discriminator.evaluate(x=discriminator_input, y=discriminator_labels)\n",
-    "\n",
-    "            \n",
-    "        batch_index = batch_index + 1\n",
-    "        discriminator_batch_losses.append(discriminator_history[0])\n",
-    "    \n",
-    "    \n",
-    "    \n",
-    "    \n",
-    "    ae_res = autoencoder.evaluate_generator(train_data)[0]\n",
-    "    adv_res = np.mean(discriminator_batch_losses)\n",
-    "    \n",
-    "    \n",
-    "    \n",
-    "    \n",
-    "    if draw:\n",
-    "        fig = plt.figure(figsize=(5 * len(samples), 5))\n",
-    "        gs = gridspec.GridSpec(1, len(samples))\n",
-    "        for i, sample in enumerate(samples):\n",
-    "            ax = plt.Subplot(fig, gs[i])\n",
-    "            ax.imshow((sample[\"image\"] * 255.).astype(\"int\"), cmap='gray')\n",
-    "            ax.set_xticks([])\n",
-    "            ax.set_yticks([])\n",
-    "            ax.set_aspect('equal')\n",
-    "            ax.set_title(sample[\"title\"])\n",
-    "            fig.add_subplot(ax)\n",
-    "        plt.show(block=False)\n",
-    "        \n",
-    "    \n",
-    "    print('Class: {}\\nae_loss: {}\\nadv_loss: {}'.format(cell_pheno, ae_res, adv_res))\n",
-    "    return [ae_res, adv_res]\n",
-    "    \n",
-    "        "
-   ]
-  },
-  {
-   "cell_type": "code",
    "execution_count": 7,
    "metadata": {},
    "outputs": [
@@ -236,42 +177,17 @@
    "metadata": {},
    "outputs": [
     {
-     "data": {
-      "text/plain": [
-       "['/home/aogorodnikov/test/polarity/Pt04_r01c01_f02_0032.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f08_0257.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f09_0342.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f10_0234.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f10_0236.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f11_0224.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f13_0716.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f14_0961.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f15_0732.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f16_0516.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f16_0548.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f16_0550.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f16_0633.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f17_0252.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f17_0557.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f17_0563.tif',\n",
-       " '/home/aogorodnikov/test/polarity/Pt04_r01c01_f17_0604.tif']"
-      ]
-     },
-     "execution_count": 8,
-     "metadata": {},
-     "output_type": "execute_result"
+     "name": "stderr",
+     "output_type": "stream",
+     "text": [
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "  warnings.warn('This ImageDataGenerator specifies '\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "  warnings.warn('This ImageDataGenerator specifies '\n"
+     ]
     }
    ],
    "source": [
-    "data_in.filepaths[:17]"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": null,
-   "metadata": {},
-   "outputs": [],
-   "source": [
     "batch_index = 0\n",
     "\n",
     "data = data_in.next()\n",
@@ -284,27 +200,11 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 10,
-   "metadata": {},
-   "outputs": [],
-   "source": [
-    "lol = [mse_batch(data_list[x], ae_pred[x], input_dim) for x in range(len(ae_pred))]"
-   ]
-  },
-  {
-   "cell_type": "code",
-   "execution_count": 11,
+   "execution_count": 25,
    "metadata": {},
    "outputs": [],
    "source": [
-    "def jsd_batch(latent_x, latent_dim):\n",
-    "    '''\n",
-    "    Function to compute adversarial loss\n",
-    "    :param latent_x: encoded latent space\n",
-    "    :return: KL divergence b/w prior\n",
-    "    '''\n",
-    "    prior = np.random.randn(latent_dim) * 5.\n",
-    "    return jsd(norm.pdf(latent_x), norm.pdf(prior))"
+    "lol1 = [mse_batch(data_list[x], ae_pred[x], input_dim) for x in range(len(ae_pred))]"
    ]
   },
   {
@@ -335,7 +235,27 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 14,
+   "execution_count": 31,
+   "metadata": {},
+   "outputs": [
+    {
+     "data": {
+      "text/plain": [
+       "0.0025168"
+      ]
+     },
+     "execution_count": 31,
+     "metadata": {},
+     "output_type": "execute_result"
+    }
+   ],
+   "source": [
+    "round(lol[0], 7)"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 34,
    "metadata": {},
    "outputs": [
     {
diff --git a/aae_test.ipynb b/aae_test.ipynb
index 276e7d6..00410d0 100644
--- a/aae_test.ipynb
+++ b/aae_test.ipynb
@@ -142,7 +142,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 3,
+   "execution_count": 1,
    "metadata": {
     "colab": {
      "base_uri": "https://localhost:8080/",
@@ -195,7 +195,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 2,
    "metadata": {
     "colab": {},
     "colab_type": "code",
@@ -222,7 +222,7 @@
     "    if conv:\n",
     "        # Assemble convolutional model\n",
     "        encoder = Sequential()\n",
-    "        encoder.add(Conv2D(32, kernel_size=(5, 5), input_shape=input_dim, padding='same', activation='relu',\n",
+    "        encoder.add(Conv2D(256, kernel_size=(5, 5), input_shape=input_dim, padding='same', activation='relu',\n",
     "                           data_format=\"channels_last\"))\n",
     "        encoder.add(MaxPooling2D(pool_size=(2, 2)))\n",
     "        encoder.add(BatchNormalization(axis=-1, momentum=0.9, epsilon=0.001))\n",
@@ -300,7 +300,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": null,
+   "execution_count": 3,
    "metadata": {
     "colab": {},
     "colab_type": "code",
@@ -385,7 +385,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 21,
+   "execution_count": 4,
    "metadata": {
     "colab": {
      "base_uri": "https://localhost:8080/",
@@ -411,7 +411,7 @@
      "data": {
       "text/html": [
        "\n",
-       "        Notebook configured with <a href=\"https://wandb.com\" target=\"_blank\">W&B</a>. You can <a href=\"https://app.wandb.ai/gvaihir_ucsf/uncategorized/runs/vdzh961d\" target=\"_blank\">open</a> the run page, or call <code>%%wandb</code>\n",
+       "        Notebook configured with <a href=\"https://wandb.com\" target=\"_blank\">W&B</a>. You can <a href=\"https://app.wandb.ai/gvaihir_ucsf/image_sudoku/runs/7r97q6xz\" target=\"_blank\">open</a> the run page, or call <code>%%wandb</code>\n",
        "        in a cell containing your training loop to display live results.  Learn more in our <a href=\"https://docs.wandb.com/docs/integrations/jupyter.html\" target=\"_blank\">docs</a>.\n",
        "    "
       ],
@@ -419,33 +419,29 @@
        "<IPython.core.display.HTML object>"
       ]
      },
-     "metadata": {
-      "tags": []
-     },
+     "metadata": {},
      "output_type": "display_data"
     },
     {
      "data": {
       "text/plain": [
-       "W&B Run: https://app.wandb.ai/gvaihir_ucsf/uncategorized/runs/vdzh961d"
+       "W&B Run: https://app.wandb.ai/gvaihir_ucsf/image_sudoku/runs/7r97q6xz"
       ]
      },
-     "execution_count": 21,
-     "metadata": {
-      "tags": []
-     },
+     "execution_count": 4,
+     "metadata": {},
      "output_type": "execute_result"
     }
    ],
    "source": [
-    "img_wd = \"data/\"\n",
+    "img_wd = \"/home/aogorodnikov/data_aae\"\n",
     "batch = 56\n",
     "input_dim = (104,104,3)\n",
     "latent_dim = 32\n",
     "epoch = 10\n",
     "conv=True\n",
     "adversarial=True\n",
-    "out=\"aae/\"\n",
+    "out=\"~/aae/\"\n",
     "# initialize monitoring with WandB\n",
     "wandb.init()\n",
     "\n",
@@ -455,7 +451,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 22,
+   "execution_count": 5,
    "metadata": {
     "colab": {
      "base_uri": "https://localhost:8080/",
@@ -481,16 +477,19 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.\n",
+      "Instructions for updating:\n",
+      "Colocations handled automatically by placer.\n",
       "Autoencoder Architecture\n",
-      "Model: \"model_7\"\n",
+      "Model: \"model_1\"\n",
       "_________________________________________________________________\n",
       "Layer (type)                 Output Shape              Param #   \n",
       "=================================================================\n",
-      "input_7 (InputLayer)         (None, 104, 104, 3)       0         \n",
+      "input_1 (InputLayer)         (None, 104, 104, 3)       0         \n",
       "_________________________________________________________________\n",
-      "sequential_10 (Sequential)   (None, 32)                22069760  \n",
+      "sequential_1 (Sequential)    (None, 32)                22069760  \n",
       "_________________________________________________________________\n",
-      "sequential_11 (Sequential)   (None, 104, 104, 3)       22053091  \n",
+      "sequential_2 (Sequential)    (None, 104, 104, 3)       22053091  \n",
       "=================================================================\n",
       "Total params: 44,122,851\n",
       "Trainable params: 44,111,843\n",
@@ -498,15 +497,15 @@
       "_________________________________________________________________\n",
       "None\n",
       "Discriminator Architecture\n",
-      "Model: \"sequential_12\"\n",
+      "Model: \"sequential_3\"\n",
       "_________________________________________________________________\n",
       "Layer (type)                 Output Shape              Param #   \n",
       "=================================================================\n",
-      "dense_34 (Dense)             (None, 2704)              89232     \n",
+      "dense_7 (Dense)              (None, 2704)              89232     \n",
       "_________________________________________________________________\n",
-      "dense_35 (Dense)             (None, 2704)              7314320   \n",
+      "dense_8 (Dense)              (None, 2704)              7314320   \n",
       "_________________________________________________________________\n",
-      "dense_36 (Dense)             (None, 1)                 2705      \n",
+      "dense_9 (Dense)              (None, 1)                 2705      \n",
       "=================================================================\n",
       "Total params: 14,812,514\n",
       "Trainable params: 7,406,257\n",
@@ -514,15 +513,15 @@
       "_________________________________________________________________\n",
       "None\n",
       "Generator Architecture\n",
-      "Model: \"model_8\"\n",
+      "Model: \"model_2\"\n",
       "_________________________________________________________________\n",
       "Layer (type)                 Output Shape              Param #   \n",
       "=================================================================\n",
-      "input_8 (InputLayer)         (None, 104, 104, 3)       0         \n",
+      "input_2 (InputLayer)         (None, 104, 104, 3)       0         \n",
       "_________________________________________________________________\n",
-      "sequential_10 (Sequential)   (None, 32)                22069760  \n",
+      "sequential_1 (Sequential)    (None, 32)                22069760  \n",
       "_________________________________________________________________\n",
-      "sequential_12 (Sequential)   (None, 1)                 7406257   \n",
+      "sequential_3 (Sequential)    (None, 1)                 7406257   \n",
       "=================================================================\n",
       "Total params: 29,476,017\n",
       "Trainable params: 22,058,752\n",
@@ -535,7 +534,7 @@
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/usr/local/lib/python3.6/dist-packages/keras/engine/training.py:493: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras/engine/training.py:493: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?\n",
       "  'Discrepancy between trainable weights and collected trainable'\n"
      ]
     }
@@ -550,7 +549,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 30,
+   "execution_count": 6,
    "metadata": {
     "colab": {
      "base_uri": "https://localhost:8080/",
@@ -598,7 +597,7 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 18,
+   "execution_count": null,
    "metadata": {
     "colab": {
      "base_uri": "https://localhost:8080/",
@@ -624,6 +623,9 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
+      "WARNING:tensorflow:From /home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.\n",
+      "Instructions for updating:\n",
+      "Use tf.cast instead.\n",
       "Epoch 1/1\n"
      ]
     },
@@ -631,9 +633,9 @@
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
       "  warnings.warn('This ImageDataGenerator specifies '\n",
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
       "  warnings.warn('This ImageDataGenerator specifies '\n"
      ]
     },
@@ -641,44 +643,37 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "20/20 [==============================] - 10s 481ms/step - loss: 783.6102 - acc: 1.8935e-05\n"
+      "20/20 [==============================] - 29s 1s/step - loss: 946.0207 - acc: 0.5277\n",
+      "generator_loss = [2.8725650310516357]\n",
+      "generator_acc = [0.05263157933950424]\n",
+      "Epoch 1/1\n",
+      "20/20 [==============================] - 25s 1s/step - loss: 929.9670 - acc: 0.5463\n",
+      "generator_loss = [3.6901795864105225]\n",
+      "generator_acc = [0.05263157933950424]\n"
      ]
     },
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/usr/local/lib/python3.6/dist-packages/keras/engine/training.py:493: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?\n",
-      "  'Discrepancy between trainable weights and collected trainable'\n",
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
-      "  warnings.warn('This ImageDataGenerator specifies '\n",
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
-      "  warnings.warn('This ImageDataGenerator specifies '\n",
-      "/usr/local/lib/python3.6/dist-packages/keras/engine/training.py:493: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?\n",
-      "  'Discrepancy between trainable weights and collected trainable'\n"
+      "wandb: Wandb version 0.8.13 is available!  To upgrade, please run:\n",
+      "wandb:  $ pip install wandb --upgrade\n"
      ]
     },
     {
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "generator_loss = [0.7109880447387695]\n",
-      "generator_acc = [0.5263158082962036]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 123ms/step - loss: 778.5844 - acc: 2.9766e-05\n",
-      "generator_loss = [1.6987814903259277]\n",
-      "generator_acc = [0.15789473056793213]\n",
-      "Epoch 1/1\n",
-      " 1/20 [>.............................] - ETA: 3s - loss: 790.0228 - acc: 0.0000e+00"
+      "Epoch 1/1\n"
      ]
     },
     {
      "name": "stderr",
      "output_type": "stream",
      "text": [
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:716: UserWarning: This ImageDataGenerator specifies `featurewise_center`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
       "  warnings.warn('This ImageDataGenerator specifies '\n",
-      "/usr/local/lib/python3.6/dist-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
+      "/home/aogorodnikov/anaconda3/envs/imgSudoku/lib/python3.7/site-packages/keras_preprocessing/image/image_data_generator.py:724: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, but it hasn't been fit on any training data. Fit it first by calling `.fit(numpy_data)`.\n",
       "  warnings.warn('This ImageDataGenerator specifies '\n"
      ]
     },
@@ -686,72 +681,7 @@
      "name": "stdout",
      "output_type": "stream",
      "text": [
-      "20/20 [==============================] - 3s 126ms/step - loss: 765.3854 - acc: 1.4304e-05\n"
-     ]
-    },
-    {
-     "name": "stderr",
-     "output_type": "stream",
-     "text": [
-      "/usr/local/lib/python3.6/dist-packages/keras/engine/training.py:493: UserWarning: Discrepancy between trainable weights and collected trainable weights, did you set `model.trainable` without calling `model.compile` after ?\n",
-      "  'Discrepancy between trainable weights and collected trainable'\n"
-     ]
-    },
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "generator_loss = [1.1789286136627197]\n",
-      "generator_acc = [0.31578946113586426]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 121ms/step - loss: 767.0341 - acc: 1.5793e-05\n",
-      "generator_loss = [1.4349550008773804]\n",
-      "generator_acc = [0.15789473056793213]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 123ms/step - loss: 768.9491 - acc: 2.1415e-05\n",
-      "generator_loss = [0.8123255968093872]\n",
-      "generator_acc = [0.5789473652839661]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 122ms/step - loss: 769.7192 - acc: 1.8852e-05\n",
-      "generator_loss = [1.4320309162139893]\n",
-      "generator_acc = [0.42105263471603394]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 122ms/step - loss: 769.4339 - acc: 1.5214e-05\n",
-      "generator_loss = [1.491897702217102]\n",
-      "generator_acc = [0.5789473652839661]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 122ms/step - loss: 764.0155 - acc: 2.3482e-05\n",
-      "generator_loss = [3.043687343597412]\n",
-      "generator_acc = [0.4736842215061188]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 123ms/step - loss: 771.0938 - acc: 2.5301e-05\n",
-      "generator_loss = [1.6088647842407227]\n",
-      "generator_acc = [0.5263158082962036]\n",
-      "Epoch 1/1\n",
-      "20/20 [==============================] - 2s 123ms/step - loss: 772.4763 - acc: 2.2242e-05\n",
-      "generator_loss = [1.1804767847061157]\n",
-      "generator_acc = [0.42105263471603394]\n"
-     ]
-    },
-    {
-     "ename": "OSError",
-     "evalue": "ignored",
-     "output_type": "error",
-     "traceback": [
-      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
-      "\u001b[0;31mOSError\u001b[0m                                   Traceback (most recent call last)",
-      "\u001b[0;32m<ipython-input-18-9756422f53a7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m     \u001b[0mautoencoder\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mautoencoder\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdiscriminator\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdiscriminator\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m     \u001b[0mgenerator\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mgenerator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mencoder\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mencoder\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdecoder\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdecoder\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m     adversarial=adversarial)\n\u001b[0m",
-      "\u001b[0;32m<ipython-input-6-68ce972a65ac>\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(train_data, out, latent_dim, n_epochs, autoencoder, discriminator, generator, encoder, decoder, adversarial)\u001b[0m\n\u001b[1;32m     67\u001b[0m                 \u001b[0mdiscriminator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'discriminator.h5'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     68\u001b[0m                 \u001b[0mgenerator\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'generator.h5'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 69\u001b[0;31m     \u001b[0mencoder\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'encoder.h5'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     70\u001b[0m     \u001b[0mdecoder\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msave\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mjoin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'decoder.h5'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     71\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0madversarial\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/keras/engine/network.py\u001b[0m in \u001b[0;36msave\u001b[0;34m(self, filepath, overwrite, include_optimizer)\u001b[0m\n\u001b[1;32m   1137\u001b[0m             \u001b[0;32mraise\u001b[0m \u001b[0mNotImplementedError\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1138\u001b[0m         \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmodels\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0msave_model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1139\u001b[0;31m         \u001b[0msave_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfilepath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moverwrite\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minclude_optimizer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1140\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1141\u001b[0m     \u001b[0;34m@\u001b[0m\u001b[0msaving\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mallow_write_to_gcs\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/keras/engine/saving.py\u001b[0m in \u001b[0;36msave_wrapper\u001b[0;34m(obj, filepath, overwrite, *args, **kwargs)\u001b[0m\n\u001b[1;32m    413\u001b[0m                 \u001b[0mos\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mremove\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtmp_filepath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    414\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 415\u001b[0;31m             \u001b[0msave_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfilepath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moverwrite\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    416\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    417\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0msave_wrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/keras/engine/saving.py\u001b[0m in \u001b[0;36msave_model\u001b[0;34m(model, filepath, overwrite, include_optimizer)\u001b[0m\n\u001b[1;32m    504\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mproceed\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    505\u001b[0m                 \u001b[0;32mreturn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 506\u001b[0;31m         \u001b[0;32mwith\u001b[0m \u001b[0mH5Dict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmode\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'w'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mh5dict\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    507\u001b[0m             \u001b[0m_serialize_model\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh5dict\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minclude_optimizer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    508\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'write'\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mcallable\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwrite\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/keras/utils/io_utils.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, path, mode)\u001b[0m\n\u001b[1;32m    189\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_is_file\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    190\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msix\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstring_types\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0m_is_path_instance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 191\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5py\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mFile\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmode\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmode\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    192\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_is_file\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    193\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpath\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdict\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/h5py/_hl/files.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, name, mode, driver, libver, userblock_size, swmr, **kwds)\u001b[0m\n\u001b[1;32m    310\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mphil\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    311\u001b[0m                 \u001b[0mfapl\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmake_fapl\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdriver\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlibver\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 312\u001b[0;31m                 \u001b[0mfid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmake_fid\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmode\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0muserblock_size\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfapl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mswmr\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mswmr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    313\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    314\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mswmr_support\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32m/usr/local/lib/python3.6/dist-packages/h5py/_hl/files.py\u001b[0m in \u001b[0;36mmake_fid\u001b[0;34m(name, mode, userblock_size, fapl, fcpl, swmr)\u001b[0m\n\u001b[1;32m    146\u001b[0m         \u001b[0mfid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcreate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mACC_EXCL\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfapl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfapl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfcpl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfcpl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    147\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mmode\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'w'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 148\u001b[0;31m         \u001b[0mfid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcreate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mh5f\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mACC_TRUNC\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfapl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfapl\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfcpl\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfcpl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    149\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mmode\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'a'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    150\u001b[0m         \u001b[0;31m# Open in append mode (read/write).\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
-      "\u001b[0;32mh5py/_objects.pyx\u001b[0m in \u001b[0;36mh5py._objects.with_phil.wrapper\u001b[0;34m()\u001b[0m\n",
-      "\u001b[0;32mh5py/_objects.pyx\u001b[0m in \u001b[0;36mh5py._objects.with_phil.wrapper\u001b[0;34m()\u001b[0m\n",
-      "\u001b[0;32mh5py/h5f.pyx\u001b[0m in \u001b[0;36mh5py.h5f.create\u001b[0;34m()\u001b[0m\n",
-      "\u001b[0;31mOSError\u001b[0m: Unable to create file (unable to open file: name = 'aae/encoder.h5', errno = 2, error message = 'No such file or directory', flags = 13, o_flags = 242)"
+      " 4/20 [=====>........................] - ETA: 24s - loss: 954.8622 - acc: 0.5529"
      ]
     }
    ],
@@ -969,16 +899,7 @@
     "id": "PP_qDCVJ4nv5",
     "outputId": "800c1d90-bb1b-450d-ed31-5742347ec8d1"
    },
-   "outputs": [
-    {
-     "name": "stdout",
-     "output_type": "stream",
-     "text": [
-      "generator_loss = [0.4478026032447815]\n",
-      "generator_acc = [1.0]\n"
-     ]
-    }
-   ],
+   "outputs": [],
    "source": [
     "print(\"generator_loss = {}\\n\"\n",
     "                  \"generator_acc = {}\".format(\n",
@@ -1227,9 +1148,9 @@
    "name": "python",
    "nbconvert_exporter": "python",
    "pygments_lexer": "ipython3",
-   "version": "3.6.8"
+   "version": "3.7.3"
   }
  },
  "nbformat": 4,
- "nbformat_minor": 2
+ "nbformat_minor": 4
 }
diff --git a/plan.ipynb b/plan.ipynb
index e70d806..519b1cb 100644
--- a/plan.ipynb
+++ b/plan.ipynb
@@ -587,7 +587,10 @@
     "\n",
     "# ToDo  \n",
     "1. Filter out negatives on for plate 4 as a test and re-cluster  \n",
-    "2. Do also grid for reconstruction"
+    "2. Do also grid for reconstruction  \n",
+    "\n",
+    "# Update 191030  \n",
+    "ACAE raedy for predictions. Tested on classes - seems that it does not very well differentiate between phenotype and normal cells (see `aae_filter_inspect`). Create a deeper net and increase number of latent dimenstions."
    ]
   },
   {
